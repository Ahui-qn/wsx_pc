(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-340f430b"],{"0615":function(t,e){let n=function(t){var e=parseFloat(t.toFixed(10)),n=e.toString(),a=n.indexOf(".");a<0&&(a=n.length,n+=".");while(n.length<=a+2)n+="0";return n};t.exports=n},4374:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"ordering"},[n("div",{staticClass:"heading"},[t._v("订单管理")]),n("div",{staticClass:"content-view"},[n("div",{staticClass:"query-view"},[n("div",{staticClass:"quotation-query"},[n("div",[t._v("交易状态")]),n("div",[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.statevalue,callback:function(e){t.statevalue=e},expression:"statevalue"}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),n("div",{staticClass:"quotation-query"},[n("el-button",{attrs:{type:"success",size:"medium"},on:{click:function(e){return t.queryFun()}}},[t._v("查询")])],1)]),n("div",{staticClass:"button-view"},[n("el-badge",{staticClass:"item",attrs:{value:t.dingdan,max:99,type:"warning"}},[n("el-button",{attrs:{size:"small"},on:{click:function(e){return t.refresh_order()}}},[t._v("刷新订单")])],1)],1),t.nodatas?n("div",[n("div",{staticClass:"tab-list"},t._l(t.tablist,(function(e,a){return n("span",{key:a},[t._v(t._s(e))])})),0),t._l(t.tabcont,(function(e,a){return n("div",{key:a,staticClass:"tab-table-quo"},[n("div",[t._v(t._s(e.order_time))]),n("div",[t._v(t._s(e.table_number))]),n("div",[t._v(t._s(e.number_of_diners))]),n("div",{staticClass:"remarks-text"},[n("el-button",{attrs:{type:"small",loading:a==t.deta_load},on:{click:function(n){return t.detailed_menu(a,e._id)}}},[t._v("详细菜单")])],1),n("div",[t._v(t._s(t.Price(e.sett_amount)))]),n("div",["mis_orders"==e.order_receiving?n("el-button",{attrs:{type:"info",size:"small",loading:a==t.rece_load},on:{click:function(n){return t.receiving(a,e._id)}}},[t._v("待接单")]):t._e(),"success"==e.transac_status?n("el-button",{attrs:{size:"small",type:"success",disabled:""}},[t._v("已结账")]):t._e(),"unsettled"==e.transac_status?n("el-button",{attrs:{size:"small",type:"success",loading:a==t.check_load},on:{click:function(n){return t.checkout(a,e._id,e._openid,e.sett_amount,e.order_no)}}},[t._v("待结账")]):t._e()],1)])})),n("el-pagination",{attrs:{background:"",layout:"prev, pager, next","hide-on-single-page":!0,total:t.total},on:{"current-change":t.currentchange}})],2):t._e(),t.nodatas?t._e():n("div",{staticClass:"nodatas"},[t._v(t._s(t.nodvalue))]),n("el-dialog",{attrs:{title:"详细菜单",visible:t.dialogVisible,width:"500px",center:!0},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",t._l(t.user_menu,(function(e,a){return n("div",{key:a,staticClass:"menu-padd"},[n("div",{staticClass:"Menu-details menu-span"},[n("span",[t._v("第"+t._s(t.user_menu.length-a)+"次下单")])]),t._l(e.goods_list,(function(e,a){return n("div",{key:a},[n("div",{staticClass:"Menu-details menu-margin"},[n("span",[t._v(t._s(e.name))]),n("span",[t._v(t._s(e.quantity)+t._s(e.unit))])])])}))],2)})),0)])],1),n("div",{staticStyle:{height:"120px"}})])},s=[],i=(n("96cf"),n("3b8d")),r=(n("78ce"),function(){var t=[{value:"success",label:"已结账"},{value:"unsettled",label:"待结账"}];return t}),o=n("0615"),c={data:function(){return{Price:o,options:r(),loading:!0,nodatas:!0,dialogVisible:!1,deta_load:-1,rece_load:-1,check_load:-1,time:"",statevalue:"",nodvalue:"没有订单数据",total:0,pagenum:0,pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},tablist:["交易时间","桌号","用餐人数","菜单详情","交易金额(元)","交易状态"],tabcont:[],user_menu:[],dingdan:0}},methods:{currentchange:function(t){this.pagenum=t-1,this.obtainorder(0)},obtainorder:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.$qs.stringify({transac_status:this.statevalue,page:this.pagenum}),t.prev=1,t.next=4,new this.Request(this.Urls.m().obtainorder+"?"+n).modeget();case 4:a=t.sent,console.log(a),this.nodatas=0!=a.data.data.tatal,this.tabcont=a.data.data.result,this.total=a.data.data.tatal,this.loading=!1,1==e&&(localStorage.setItem("order_num",0),this.$store.commit("order_remind",0)),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),new this.mytitle(this.$message,"error","服务器发生错误,请重试").funtitle();case 16:case"end":return t.stop()}}),t,this,[[1,13]])})));function e(e){return t.apply(this,arguments)}return e}(),detailed_menu:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.deta_load=e,t.prev=1,t.next=4,new this.Request(this.Urls.m().vieworder+"?id="+n).modeget();case 4:a=t.sent,console.log(a),this.user_menu=a.data.data,this.deta_load=-1,this.dialogVisible=!0,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](1),this.deta_load=-1,new this.mytitle(this.$message,"error","服务器发生错误,请重试").funtitle();case 15:case"end":return t.stop()}}),t,this,[[1,11]])})));function e(e,n){return t.apply(this,arguments)}return e}(),receiving:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.rece_load=e,t.prev=1,t.next=4,new this.Request(this.Urls.m().receiving+"?id="+n).modeget();case 4:a=t.sent,this.$set(this.tabcont[e],"order_receiving","rec_order"),new this.mytitle(this.$message,"success",a.data.msg).funtitle(),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),new this.mytitle(this.$message,"error","服务器发生错误,请重试").funtitle();case 12:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(e,n){return t.apply(this,arguments)}return e}(),checkout:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,n,a,s,i){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.check_load=e,r=this.$qs.stringify({id:n,openid:a,sett_amount:s,order_no:i}),t.prev=2,t.next=5,new this.Request(this.Urls.m().checkout+"?"+r).modeget();case 5:o=t.sent,console.log(o),this.$set(this.tabcont[e],"transac_status","success"),new this.mytitle(this.$message,"success",o.data.msg).funtitle(),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),new this.mytitle(this.$message,"error","服务器发生错误,请重试").funtitle();case 14:case"end":return t.stop()}}),t,this,[[2,11]])})));function e(e,n,a,s,i){return t.apply(this,arguments)}return e}(),refresh_order:function(){this.loading=!0,this.deta_load=-1,this.rece_load=-1,this.check_load=-1,this.obtainorder(1)},queryFun:function(){this.pagenum=0,this.obtainorder(0)}},created:function(){this.obtainorder(0),this.dingdan=localStorage.getItem("order_num")},watch:{"$store.state.remind":function(t,e){this.dingdan=t.num}}},u=c,l=(n("bc59"),n("2877")),d=Object(l["a"])(u,a,s,!1,null,"49da5b92",null);e["default"]=d.exports},"78ce":function(t,e,n){var a=n("5ca1");a(a.S,"Date",{now:function(){return(new Date).getTime()}})},a940:function(t,e,n){},bc59:function(t,e,n){"use strict";n("a940")}}]);
//# sourceMappingURL=chunk-340f430b.7895b4a3.js.map